<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ _('Audit Logs - Smart Resource Booking') }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* Basic styling for the filters for now */
        .filters-section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 5px;
        }
        .filters-section label {
            margin-right: 5px;
        }
        .filters-section input[type="date"],
        .filters-section input[type="text"],
        .filters-section select {
            margin-right: 15px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .filters-section button {
            padding: 8px 15px;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li id="welcome-message-container" style="display:none; margin-right: 10px;"></li>
                <li id="user-dropdown-container" style="display:none; position: relative; margin-right: 20px;">
                    <button id="user-dropdown-button" aria-haspopup="true" aria-expanded="false" aria-controls="user-dropdown-menu" style="background: none; border: none; color: white; font-size: 1em; font-weight: bold; cursor: pointer; padding: 0;"></button>
                    <ul id="user-dropdown-menu" role="menu" style="display:none; position: absolute; top: 100%; left: 0; background-color: #2c3e50; border: 1px solid #555; border-top: none; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 100; list-style-type: none; padding: 0; margin: 0; border-radius: 0 0 4px 4px;">
                        <li><a href="{{ url_for('serve_profile_page') }}" role="menuitem" style="display: block; padding: 10px 15px; text-decoration: none; color: white;">{{ _('View Profile') }}</a></li>
                        <li><a href="#" id="logout-link-dropdown" role="menuitem" style="display: block; padding: 10px 15px; text-decoration: none; color: white;">{{ _('Logout') }}</a></li>
                    </ul>
                </li>
                <li><a href="{{ url_for('serve_index') }}">{{ _('Home') }}</a></li>
                <li><a href="{{ url_for('serve_new_booking') }}">{{ _('New Booking') }}</a></li>
                <li><a href="{{ url_for('serve_resources') }}">{{ _('View Resources') }}</a></li>
                <li id="my-bookings-nav-link" style="display:none;"><a href="{{ url_for('serve_my_bookings_page') }}">{{ _('My Bookings') }}</a></li>
                <li id="admin-maps-nav-link" style="display:none;"><a href="{{ url_for('serve_admin_maps') }}">{{ _('Admin Maps') }}</a></li>
                <li id="user-management-nav-link" style="display:none;"><a href="{{ url_for('serve_user_management_page') }}">{{ _('User Management') }}</a></li>
                <li id="log-nav-link" style="display:none;"><a href="{{ url_for('serve_audit_log_page') }}">{{ _('Audit Logs') }}</a></li>
                <li id="auth-link-container" style="display:none;"></li> 
            </ul>
        </nav>
    </header>

    <main>
        <h1>{{ _('Audit Logs') }}</h1>
        <div id="log-view-status" class="status-message" style="margin-bottom: 15px;"></div>

        <div class="filters-section">
            <h3>{{ _('Filters') }}</h3>
            <label for="log-filter-start-date">{{ _('Start Date:') }}</label>
            <input type="date" id="log-filter-start-date" name="log_filter_start_date">

            <label for="log-filter-end-date">{{ _('End Date:') }}</label>
            <input type="date" id="log-filter-end-date" name="log_filter_end_date">

            <label for="log-filter-username">{{ _('Username:') }}</label>
            <input type="text" id="log-filter-username" name="log_filter_username" placeholder="{{ _('Filter by Username') }}">

            <label for="log-filter-action">{{ _('Action Type:') }}</label>
            <input type="text" id="log-filter-action" name="log_filter_action" placeholder="{{ _('Filter by Action') }}">
            
            <button id="log-apply-filters-btn" class="button">{{ _('Apply Filters') }}</button>
            <button id="log-clear-filters-btn" class="button">{{ _('Clear Filters') }}</button>
        </div>

        <table id="audit-log-table" class="styled-table">
            <thead>
                <tr>
                    <th>{{ _('Timestamp') }}</th>
                    <th>{{ _('User ID') }}</th>
                    <th>{{ _('Username') }}</th>
                    <th>{{ _('Action') }}</th>
                    <th>{{ _('Details') }}</th>
                </tr>
            </thead>
            <tbody>
                <!-- Log entries will be populated by JavaScript -->
            </tbody>
        </table>
         <div id="pagination-controls" style="margin-top: 20px; text-align: center;">
            <button id="prev-page-btn" class="button" disabled>&laquo; {{ _('Previous') }}</button>
            <span id="page-info" style="margin: 0 15px;">{{ _('Page 1 of 1') }}</span> {# Note: JS will update this dynamically #}
            <button id="next-page-btn" class="button" disabled>{{ _('Next') }} &raquo;</button>
            <br>
            <span id="total-logs-info" style="display: block; margin-top: 5px;"></span>
        </div>
    </main>

    <footer>
        <p>{{ _('&copy; 2024 Smart Resource Booking') }}</p>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
    <script src="{{ url_for('static', filename='js/log_view.js') }}" defer></script>
</body>
</html>
