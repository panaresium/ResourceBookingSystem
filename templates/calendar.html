{% extends "base.html" %}

{% block title %}{{ _('Booking Calendar') }}{% endblock %}

{% block head_extra %}
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
<h2>{{ _('My Calendar') }}</h2>

<div class="mb-3">
    <label for="calendar-status-filter" class="form-label">{{ _('Filter by Status:') }}</label>
    <select id="calendar-status-filter" class="form-select">
        {# Options will be populated by JavaScript #}
    </select>
</div>

<div id="calendar" {% if current_user.is_authenticated %}data-user-id="{{ current_user.id }}"{% endif %}></div>

<div id="calendar-edit-booking-modal" class="modal" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="cebm-title">
    <div class="modal-content">
        <span id="cebm-close-modal-btn" class="close-modal-btn" role="button" aria-label="{{ _('Close modal') }}">&times;</span>
        <h3 id="cebm-title">{{ _('Edit Booking') }}</h3>
        <p>{{ _('Resource:') }} <strong id="cebm-resource-name">N/A</strong></p>
        <input type="hidden" id="cebm-booking-id">
        <input type="hidden" id="cebm-resource-id">
        <div>
            <label for="cebm-booking-title">{{ _('Booking Title:') }}</label>
            <input type="text" id="cebm-booking-title" name="booking_title" class="form-control">
        </div>
       <div>
           <label for="cebm-booking-date">{{ _('Date:') }}</label>
           <input type="date" id="cebm-booking-date" name="booking_date" class="form-control">
       </div>
       <div>
           <label for="cebm-available-slots-select">{{ _('Available Time Slots:') }}</label>
           <select id="cebm-available-slots-select" name="available_slots" class="form-select">
               <option value="">-- {{ _('Select a time slot') }} --</option>
           </select>
       </div>
        <button id="cebm-save-changes-btn" class="button" style="margin-top: 15px;">{{ _('Save Changes') }}</button>
        <button id="cebm-delete-booking-btn" class="button" style="margin-top: 15px; background-color: #dc3545; color: white; margin-left: 10px;">{{ _('Delete Booking') }}</button>
        <div id="cebm-status-message" class="status-message" style="margin-top:10px;"></div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script src="{{ url_for('static', filename='js/calendar.js') }}" defer></script>
{% endblock %}
