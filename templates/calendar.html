{% extends "base.html" %}

{% block title %}{{ _('Booking Calendar') }}{% endblock %}

{% block head_extra %}
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
<h2>{{ _('My Calendar') }}</h2>

<div class="mb-3">
    <label for="calendar-resource-select" class="form-label">{{ _('Filter by Resource:') }}</label> {# Changed label for clarity #}
    <select id="calendar-resource-select" class="form-select">
        <option value="all" selected>-- {{ _('All My Booked Resources') }} --</option>
        {# Options for individual resources will be populated by JavaScript #}
    </select>
</div>

<div id="calendar"></div>

{% include '_booking_modal.html' %} {# Include the shared modal #}

{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    // Make username available to scripts
    // Ideally, this would be on the body tag in base.html: <body data-user-name="{{ current_user.username }}">
    // Adding it here to fulfill dependency for booking_modal_handler.js and calendar.js
    document.addEventListener('DOMContentLoaded', function() {
        {% if current_user and current_user.is_authenticated %}
            document.body.dataset.userName = "{{ current_user.username }}";
        {% else %}
            document.body.dataset.userName = ""; // Set to empty if no user or not authenticated
        {% endif %}
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script src="{{ url_for('static', filename='js/booking_modal_handler.js') }}" defer></script>
<script src="{{ url_for('static', filename='js/calendar.js') }}" defer></script>
{% endblock %}
